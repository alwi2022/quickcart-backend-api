"use strict";(()=>{var e={};e.id=452,e.ids=[452],e.modules={6037:e=>{e.exports=require("mongoose")},846:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4870:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:e=>{e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9294:e=>{e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},9428:e=>{e.exports=require("buffer")},5511:e=>{e.exports=require("crypto")},7910:e=>{e.exports=require("stream")},8354:e=>{e.exports=require("util")},725:(e,r,t)=>{t.r(r),t.d(r,{patchFetch:()=>k,routeModule:()=>y,serverHooks:()=>v,workAsyncStorage:()=>f,workUnitAsyncStorage:()=>x});var a={};t.r(a),t.d(a,{DELETE:()=>h,GET:()=>w,PATCH:()=>m,runtime:()=>l});var i=t(1271),s=t(1232),n=t(8079),o=t(3418),u=t(9999),d=t(3947),p=t(5642),c=t(9902);let l="nodejs";async function w(e,{params:r}){try{await (0,p.ZT)(),await (0,o.T)();let e=await u.KJ.findById(r.id).select("-password_hash").lean();if(!e)throw new d.v7("User tidak ditemukan");return(0,d.Pq)({item:e})}catch(e){return(0,d.hS)(e)}}async function m(e,{params:r}){try{await (0,p.ZT)(),await (0,o.T)();let t=await e.json(),a=await u.KJ.findById(r.id);if(!a)throw new d.v7("User tidak ditemukan");return void 0!==t.name&&(a.name=t.name),void 0!==t.email&&(a.email=t.email),void 0!==t.phone&&(a.phone=t.phone),void 0!==t.password&&(a.password_hash=await (0,c.E)(t.password)),Array.isArray(t.roles)&&(a.roles=t.roles),t.status&&(a.status=t.status),await a.save(),(0,d.Pq)({item:{_id:a._id}})}catch(e){if(e?.code===11e3&&e?.keyPattern?.email)return(0,d.Pq)({error:"Email sudah terpakai"},{status:400});return(0,d.hS)(e)}}async function h(e,{params:r}){try{return await (0,p.ZT)(),await (0,o.T)(),await u.KJ.findByIdAndDelete(r.id),(0,d.Pq)({ok:!0})}catch(e){return(0,d.hS)(e)}}let y=new i.AppRouteRouteModule({definition:{kind:s.RouteKind.APP_ROUTE,page:"/api/admin/users/[id]/route",pathname:"/api/admin/users/[id]",filename:"route",bundlePath:"app/api/admin/users/[id]/route"},resolvedPagePath:"C:\\Users\\imamb\\Desktop\\QuickCart\\apps\\backend\\app\\api\\admin\\users\\[id]\\route.js",nextConfigOutput:"",userland:a}),{workAsyncStorage:f,workUnitAsyncStorage:x,serverHooks:v}=y;function k(){return(0,n.patchFetch)({workAsyncStorage:f,workUnitAsyncStorage:x})}},5642:(e,r,t)=>{t.d(r,{JR:()=>o,ZT:()=>u});var a=t(255),i=t(2171),s=t(3947);async function n(){let e=await (0,a.UL)(),r=e.get("gt_auth")?.value;if(!r)throw new s.D_("Unauthorized");return(0,i.nr)(r)}async function o(){let e=await n();if(!e?.sub)throw new s.D_("Unauthorized");return e}async function u(){let e=await o();if(!(Array.isArray(e?.roles)?e.roles:[]).includes("admin"))throw new s.qQ("Forbidden");return e}}};var r=require("../../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[79,388,365,255,483,795],()=>t(725));module.exports=a})();