(()=>{var e={};e.id=786,e.ids=[786],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},9428:e=>{"use strict";e.exports=require("buffer")},5511:e=>{"use strict";e.exports=require("crypto")},7910:e=>{"use strict";e.exports=require("stream")},8354:e=>{"use strict";e.exports=require("util")},5217:e=>{"use strict";e.exports=require("node:crypto")},8359:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>w,routeModule:()=>x,serverHooks:()=>f,workAsyncStorage:()=>y,workUnitAsyncStorage:()=>v});var s={};t.r(s),t.d(s,{POST:()=>h,runtime:()=>d});var n=t(1271),a=t(1232),o=t(8079),i=t(5217),u=t(3947),c=t(5642);let d="nodejs",p=process.env.CLOUDINARY_CLOUD_NAME,l=process.env.CLOUDINARY_API_KEY,m=process.env.CLOUDINARY_API_SECRET;async function h(e){try{(0,c.ZT)();let{public_id:r}=await e.json();if(!r)throw new u.v7("public_id wajib");if(!p||!l||!m)throw new u.v7("Cloudinary env missing");let t=Math.floor(Date.now()/1e3),s=`public_id=${r}&timestamp=${t}${m}`,n=i.createHash("sha1").update(s).digest("hex"),a=new URLSearchParams;a.set("public_id",r),a.set("timestamp",String(t)),a.set("api_key",l),a.set("signature",n);let o=`https://api.cloudinary.com/v1_1/${p}/image/destroy`,d=await fetch(o,{method:"POST",body:a}),h=await d.json();if(!d.ok||"ok"!==h.result)return(0,u.Pq)({error:h?.error?.message||"Destroy gagal"},{status:400});return(0,u.Pq)({ok:!0})}catch(e){return(0,u.hS)(e)}}let x=new n.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/admin/uploads/cloudinary-destroy/route",pathname:"/api/admin/uploads/cloudinary-destroy",filename:"route",bundlePath:"app/api/admin/uploads/cloudinary-destroy/route"},resolvedPagePath:"C:\\Users\\imamb\\Desktop\\QuickCart\\apps\\backend\\app\\api\\admin\\uploads\\cloudinary-destroy\\route.js",nextConfigOutput:"",userland:s}),{workAsyncStorage:y,workUnitAsyncStorage:v,serverHooks:f}=x;function w(){return(0,o.patchFetch)({workAsyncStorage:y,workUnitAsyncStorage:v})}},7032:()=>{},408:()=>{},5642:(e,r,t)=>{"use strict";t.d(r,{JR:()=>i,ZT:()=>u});var s=t(255),n=t(2171),a=t(3947);async function o(){let e=await (0,s.UL)(),r=e.get("gt_auth")?.value;if(!r)throw new a.D_("Unauthorized");return(0,n.nr)(r)}async function i(){let e=await o();if(!e?.sub)throw new a.D_("Unauthorized");return e}async function u(){let e=await i();if(!(Array.isArray(e?.roles)?e.roles:[]).includes("admin"))throw new a.qQ("Forbidden");return e}},3947:(e,r,t)=>{"use strict";t.d(r,{D_:()=>o,Pq:()=>c,hS:()=>d,m_:()=>u,qQ:()=>i,v7:()=>a});var s=t(3022);class n extends Error{constructor(e,r=500,t){super(e),this.name=this.constructor.name,this.status=r,this.details=t}}class a extends n{constructor(e="Bad Request",r){super(e,400,r)}}class o extends n{constructor(e="Unauthorized",r){super(e,401,r)}}class i extends n{constructor(e="Forbidden",r){super(e,403,r)}}class u extends n{constructor(e="Not Found",r){super(e,404,r)}}function c(e,r={}){let t=r.status||200,s=new Headers(r.headers||void 0);return s.has("Content-Type")||s.set("Content-Type","application/json"),new Response(JSON.stringify(e),{status:t,headers:s})}function d(e){if(e instanceof s.G){let r=e instanceof s.G?new a("Validation error",e.issues.map(e=>({path:e.path.join("."),message:e.message,code:e.code}))):e;return c({error:r.message,details:r.details},{status:r.status})}return e instanceof n?c({error:e.message,details:e.details},{status:e.status}):e?.name==="JsonWebTokenError"?c({error:"Invalid token"},{status:401}):e?.name==="TokenExpiredError"?c({error:"Token expired"},{status:401}):(console.error("[API ERROR]",e),c({error:"Internal Server Error"},{status:500}))}},2171:(e,r,t)=>{"use strict";t.d(r,{nr:()=>i,zF:()=>o});var s=t(365);let n=process.env.JWT_SECRET,a=process.env.JWT_EXPIRES_IN||"7d";function o(e,r={}){return s.sign(e,n,{expiresIn:r.expiresIn||a})}function i(e){return s.verify(e,n)}n||console.warn("JWT_SECRET is not set. Set it in .env.local")}};var r=require("../../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[79,388,365,255],()=>t(8359));module.exports=s})();