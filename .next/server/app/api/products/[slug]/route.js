(()=>{var e={};e.id=970,e.ids=[970],e.modules={6037:e=>{"use strict";e.exports=require("mongoose")},846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},7827:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>g,routeModule:()=>o,serverHooks:()=>y,workAsyncStorage:()=>c,workUnitAsyncStorage:()=>l});var i={};r.r(i),r.d(i,{GET:()=>m,runtime:()=>p});var n=r(1271),a=r(1232),d=r(8079),s=r(3418),u=r(9999);let p="nodejs";async function m(e,{params:t}){await (0,s.T)();let{slug:r}=t,i=await u.Yt.findOne({slug:r,status:"active"}).lean();if(!i)return new Response(JSON.stringify({message:"Not found"}),{status:404});let n=await u.p_.find({productId:i._id,status:"published"}).sort("-createdAt").limit(10).lean();return Response.json({product:i,reviews:n})}let o=new n.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/products/[slug]/route",pathname:"/api/products/[slug]",filename:"route",bundlePath:"app/api/products/[slug]/route"},resolvedPagePath:"C:\\Users\\imamb\\Desktop\\QuickCart\\apps\\backend\\app\\api\\products\\[slug]\\route.js",nextConfigOutput:"",userland:i}),{workAsyncStorage:c,workUnitAsyncStorage:l,serverHooks:y}=o;function g(){return(0,d.patchFetch)({workAsyncStorage:c,workUnitAsyncStorage:l})}},7032:()=>{},408:()=>{},1271:(e,t,r)=>{"use strict";e.exports=r(4870)},3418:(e,t,r)=>{"use strict";r.d(t,{T:()=>d});var i=r(6037);let n=process.env.MONGODB_URI||"mongodb://localhost:27017/GalaTech";if(console.log(n,"ini MONGODB_URI"),!n)throw Error("Please define the MONGODB_URI env var in .env.local");let a=global.mongoose;async function d(){return a.conn||(a.promise||(a.promise=i.connect(n,{bufferCommands:!1,dbName:process.env.MONGODB_DB,maxPoolSize:10}).then(e=>e)),a.conn=await a.promise),a.conn}a||(a=global.mongoose={conn:null,promise:null})},9999:(e,t,r)=>{"use strict";r.d(t,{mz:()=>u,Z3:()=>f,b7:()=>m,rI:()=>S,pH:()=>w,p2:()=>O,Yt:()=>y,p_:()=>q,KJ:()=>d,ar:()=>D});var i=r(6037);let n=new i.Schema({label:String,receiver_name:String,phone:String,street:String,subdistrict:String,city:String,province:String,postal_code:String,country:{type:String,default:"ID"},is_default:{type:Boolean,default:!1},geo:{lat:Number,lng:Number}},{_id:!0}),a=new i.Schema({email:{type:String,index:!0,unique:!0,sparse:!0},phone:{type:String,index:!0,unique:!0,sparse:!0},name:String,password_hash:String,roles:{type:[String],default:["customer"]},status:{type:String,enum:["active","blocked","deleted"],default:"active"},default_address_id:{type:i.Schema.Types.ObjectId},addresses:[n]},{timestamps:!0}),d=i.models.User||i.model("User",a),s=new i.Schema({slug:{type:String,unique:!0,index:!0},name:{type:String,required:!0},logo_url:String,logo_public_id:{type:String,default:""},country:String,status:{type:String,enum:["active","inactive"],default:"active"}},{timestamps:!0});s.index({name:"text"});let u=i.models.Brand||i.model("Brand",s),p=new i.Schema({slug:{type:String,unique:!0,index:!0},name:{type:String,required:!0},image:{type:String,required:!0},parent_id:{type:i.Schema.Types.ObjectId,ref:"Category",default:null},ancestors:[{_id:{type:i.Schema.Types.ObjectId,ref:"Category"},name:String,slug:String}],order:{type:Number,default:0}},{timestamps:!0});p.index({parent_id:1,order:1});let m=i.models.Category||i.model("Category",p),o=new i.Schema({url:String,alt:String},{_id:!1}),c=new i.Schema({sku:{type:String,index:!0,unique:!0},options:{type:i.Schema.Types.Mixed},price:{currency:{type:String,default:"IDR"},list:{type:Number,required:!0},sale:{type:Number,default:null},startAt:Date,endAt:Date},weightGram:Number,dimensionsCm:{l:Number,w:Number,h:Number},barcode:String,status:{type:String,enum:["active","inactive"],default:"active"}},{_id:!0}),l=new i.Schema({slug:{type:String,unique:!0,index:!0},sku:String,title:{type:String,required:!0},subtitle:String,brandId:{type:i.Schema.Types.ObjectId,ref:"Brand"},categoryIds:[{type:i.Schema.Types.ObjectId,ref:"Category"}],descriptionHtml:String,media:[o],attributes:i.Schema.Types.Mixed,variants:{type:[c],validate:e=>e.length>0},seo:{title:String,metaDescription:String},status:{type:String,enum:["active","draft","archived"],default:"active"},rating:{avg:{type:Number,default:0},count:{type:Number,default:0}},soldCount:{type:Number,default:0},viewCount:{type:Number,default:0}},{timestamps:!0});l.index({title:"text"}),l.index({brandId:1}),l.index({categoryIds:1}),l.index({status:1}),l.index({updatedAt:-1});let y=i.models.Product||(0,i.model)("Product",l),g=new i.Schema({product_id:{type:i.Schema.Types.ObjectId,ref:"Product",index:!0},variant_id:{type:i.Schema.Types.ObjectId,index:!0},warehouse_id:{type:String,default:"JKT-01"},on_hand:{type:Number,default:0},reserved:{type:Number,default:0}},{timestamps:!0});g.index({product_id:1,variant_id:1,warehouse_id:1},{unique:!0});let S=i.models.Inventory||i.model("Inventory",g),h=new i.Schema({productId:{type:i.Schema.Types.ObjectId,ref:"Product"},variantId:{type:i.Schema.Types.ObjectId},sku:String,title:String,variantLabel:String,qty:{type:Number,default:1},priceSnapshot:{currency:String,unit:Number},addedAt:{type:Date,default:Date.now}},{_id:!0}),b=new i.Schema({userId:{type:i.Schema.Types.ObjectId,ref:"User",index:!0},sessionId:{type:String,index:!0},items:[h],couponCodes:[String],notes:String},{timestamps:!0}),f=i.models.Cart||(0,i.model)("Cart",b),v=new i.Schema({productId:{type:i.Schema.Types.ObjectId,ref:"Product"},variantId:{type:i.Schema.Types.ObjectId},sku:String,title:String,variantLabel:String,qty:{type:Number,required:!0},price:{currency:{type:String,default:"IDR"},unit:{type:Number,required:!0},subtotal:{type:Number,required:!0}},weightGram:Number},{_id:!0}),I=new i.Schema({receiverName:String,phone:String,street:String,subdistrict:String,city:String,province:String,postalCode:String,country:String},{_id:!1}),x=new i.Schema({orderNo:{type:String,unique:!0,index:!0},userId:{type:i.Schema.Types.ObjectId,ref:"User",index:!0},status:{type:String,enum:["awaiting_payment","paid","processing","shipped","completed","cancelled","refunded"],default:"awaiting_payment"},channel:{type:String,default:"web"},items:[v],pricing:{subtotal:Number,discounts:[{code:String,amount:Number}],shippingCost:Number,tax:Number,grandTotal:Number},shippingAddress:I,billingAddress:I,payment:{paymentId:{type:i.Schema.Types.ObjectId,ref:"Payment"},method:String,status:{type:String,enum:["pending","paid","failed","expired"],default:"pending"}},shipment:{shipmentId:{type:i.Schema.Types.ObjectId,ref:"Shipment"},courier:String,service:String,trackingNo:String},placedAt:{type:Date,default:Date.now}},{timestamps:!0});x.index({userId:1,placedAt:-1}),x.index({status:1,placedAt:-1});let w=i.models.Order||(0,i.model)("Order",x),N=new i.Schema({orderId:{type:i.Schema.Types.ObjectId,ref:"Order",unique:!0},provider:String,method:String,amount:Number,currency:{type:String,default:"IDR"},status:{type:String,enum:["pending","paid","failed","expired","refunded"],default:"pending"},externalRef:{type:String,index:!0},vaNumber:String,paidAt:Date,raw:i.Schema.Types.Mixed},{timestamps:!0});N.index({status:1,createdAt:-1});let O=i.models.Payment||(0,i.model)("Payment",N),_=new i.Schema({status:String,at:Date},{_id:!1}),T=new i.Schema({orderId:{type:i.Schema.Types.ObjectId,ref:"Order",unique:!0},warehouseId:{type:String,default:"MAIN"},courier:String,service:String,trackingNo:{type:String,unique:!0,sparse:!0},status:{type:String,enum:["packed","shipped","in_transit","delivered","failed"],default:"packed"},history:[_]},{timestamps:!0});i.models.Shipment||(0,i.model)("Shipment",T);let j=new i.Schema({product_id:{type:i.Schema.Types.ObjectId,ref:"Product",index:!0},variant_id:{type:i.Schema.Types.ObjectId},order_id:{type:i.Schema.Types.ObjectId,ref:"Order"},user_id:{type:i.Schema.Types.ObjectId,ref:"User"},rating:{type:Number,min:1,max:5},title:String,content:String,media:[{url:String}],helpful_count:{type:Number,default:0},status:{type:String,enum:["pending","published","rejected"],default:"pending"}},{timestamps:!0});j.index({status:1,createdAt:-1});let q=i.models.Review||i.model("Review",j),A=new i.Schema({userId:{type:i.Schema.Types.ObjectId,ref:"User",unique:!0},items:[{productId:{type:i.Schema.Types.ObjectId,ref:"Product"},addedAt:{type:Date,default:Date.now}}]},{timestamps:!0}),D=i.models.Wishlist||(0,i.model)("Wishlist",A),k=new i.Schema({code:{type:String,unique:!0,index:!0},type:{type:String,enum:["flat","percent","shipping","bundle"],default:"flat"},value:Number,minOrder:{type:Number,default:0},maxDiscount:{type:Number,default:null},startAt:Date,endAt:Date,usageLimit:Number,usageCount:{type:Number,default:0},constraints:{brandIds:[i.Schema.Types.ObjectId],categoryIds:[i.Schema.Types.ObjectId],firstOrderOnly:{type:Boolean,default:!1}},status:{type:String,enum:["active","inactive"],default:"active"}},{timestamps:!0});k.index({status:1,startAt:1,endAt:1}),i.models.Coupon||(0,i.model)("Coupon",k);let C=new i.Schema({slot:{type:String,index:!0},title:String,imageUrl:String,linkUrl:String,startAt:Date,endAt:Date,priority:{type:Number,default:0},status:{type:String,enum:["active","inactive"],default:"active"}},{timestamps:!0});C.index({slot:1,status:1,startAt:1,endAt:1}),i.models.Banner||(0,i.model)("Banner",C);let P=new i.Schema({type:{type:String,index:!0},ref:{type:i.Schema.Types.Mixed},userId:{type:i.Schema.Types.ObjectId,ref:"User"},meta:i.Schema.Types.Mixed},{timestamps:{createdAt:!0,updatedAt:!1}});P.index({"ref.orderId":1,createdAt:-1}),P.index({createdAt:-1}),i.models.Event||(0,i.model)("Event",P);let R=new i.Schema({orderItemSku:String,qty:Number,reason:String},{_id:!1}),U=new i.Schema({orderId:{type:i.Schema.Types.ObjectId,ref:"Order"},items:[R],status:{type:String,enum:["requested","approved","rejected","received","refunded"],default:"requested"},refund:{amount:Number,method:{type:String,default:"original"}}},{timestamps:!0});i.models.Return||(0,i.model)("Return",U)}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[79],()=>r(7827));module.exports=i})();